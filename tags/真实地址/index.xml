<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>真实地址 on ephz3nt</title><link>https://ephz3nt.github.io/tags/%E7%9C%9F%E5%AE%9E%E5%9C%B0%E5%9D%80/</link><description>Recent content in 真实地址 on ephz3nt</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Fri, 25 Jul 2014 22:04:36 +0000</lastBuildDate><atom:link href="https://ephz3nt.github.io/tags/%E7%9C%9F%E5%AE%9E%E5%9C%B0%E5%9D%80/index.xml" rel="self" type="application/rss+xml"/><item><title>Discuz显示音乐以及除图片外文件的真实链接。</title><link>https://ephz3nt.github.io/posts/tech/2014/discuz-true-attachment-links/</link><pubDate>Fri, 25 Jul 2014 22:04:36 +0000</pubDate><guid>https://ephz3nt.github.io/posts/tech/2014/discuz-true-attachment-links/</guid><description>由于自己的音乐论坛一直找不到好的外链，所以干脆自己搭个算了 想找一个支持直链的开源站点小程序用，但是一直都没有找到 于是开始了Discuz远程附件折腾之旅。
都知道Discuz远程附件的机制蛋疼至极，图片可以直接显示链接，其他文件不行 折腾了一天，终于搞定 打开
\source\function\function_discuzcode.php 找到
function parseattachurl($aid, $ext, $ignoretid = 0) 将
function parseattachurl($aid, $ext, $ignoretid = 0) { global $_G; $_G[&#39;forum_skipaidlist&#39;][] = $aid; return $_G[&#39;siteurl&#39;].&#39;forum.php?mod=attachment&amp;amp;amp;aid=&#39;.aidencode($aid, $ext, $ignoretid ? &#39;&#39; : $_G[&#39;tid&#39;]).($ext ? &#39;&amp;amp;amp;request=yes&amp;amp;amp;_f=.&#39;.$ext : &#39;&#39;); } 替换为
function parseattachurl($aid, $ext, $ignoretid = 0) { global $_G; $_G[&#39;forum_skipaidlist&#39;][] = $aid; $aid = intval($aid); $attach = DB::fetch_first(&amp;quot;SELECT * FROM &amp;quot;.DB::table(&#39;forum_attachment&#39;).&amp;quot; WHERE aid=&#39;$aid&#39;&amp;quot;); $tid = $attach[&#39;tableid&#39;]; $attach = DB::fetch_first(&amp;quot;SELECT * FROM &amp;quot;.</description></item></channel></rss>
<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>附件链接 on ephz3nt</title><link>https://painso.com/tags/%E9%99%84%E4%BB%B6%E9%93%BE%E6%8E%A5/</link><description>Recent content in 附件链接 on ephz3nt</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Fri, 25 Jul 2014 22:04:36 +0000</lastBuildDate><atom:link href="https://painso.com/tags/%E9%99%84%E4%BB%B6%E9%93%BE%E6%8E%A5/index.xml" rel="self" type="application/rss+xml"/><item><title>Discuz显示音乐以及除图片外文件的真实链接。</title><link>https://painso.com/posts/tech/2014/discuz-true-attachment-links/</link><pubDate>Fri, 25 Jul 2014 22:04:36 +0000</pubDate><guid>https://painso.com/posts/tech/2014/discuz-true-attachment-links/</guid><description>由于自己的音乐论坛一直找不到好的外链，所以干脆自己搭个算了 想找一个支持直链的开源站点小程序用，但是一直都没有找到 于是开始了Discuz远程附件折腾之旅。
都知道Discuz远程附件的机制蛋疼至极，图片可以直接显示链接，其他文件不行 折腾了一天，终于搞定 打开
\source\function\function_discuzcode.php 找到
function parseattachurl($aid, $ext, $ignoretid = 0) 将
function parseattachurl($aid, $ext, $ignoretid = 0) { global $_G; $_G['forum_skipaidlist'][] = $aid; return $_G['siteurl'].'forum.php?mod=attachment&amp;amp;amp;aid='.aidencode($aid, $ext, $ignoretid ? '' : $_G['tid']).($ext ? '&amp;amp;amp;request=yes&amp;amp;amp;_f=.'.$ext : ''); } 替换为
function parseattachurl($aid, $ext, $ignoretid = 0) { global $_G; $_G['forum_skipaidlist'][] = $aid; $aid = intval($aid); $attach = DB::fetch_first(&amp;quot;SELECT * FROM &amp;quot;.DB::table('forum_attachment').&amp;quot; WHERE aid='$aid'&amp;quot;); $tid = $attach['tableid']; $attach = DB::fetch_first(&amp;quot;SELECT * FROM &amp;quot;.</description></item></channel></rss>